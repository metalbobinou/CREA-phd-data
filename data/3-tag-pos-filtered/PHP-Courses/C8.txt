informa=que
modélisa=on
uml
objec-fs
de
séance
:
créa-on
d’un
site
web
dynamique
php
php
•
php
être
langage
de
programma-on
u=lisé
pour
construc=on
de
site
web
dynamiques
–
page
php
:
page
web
con=ennent
de
php
•
aller
mélanger
php
code
html
/
css
•
code
php
aller
être
analyser
par
serveur
•
résultat
aller
être
nouvelle
page
web
mettre
à
jour
automa=quement
par
code
php
coursphp-1.php
<html>
…
code
php
être
à
<?php
l’intérieur
de
balise
date_default_-mezone_set("europe/paris");
<?php
…
?>
entourer
par
balise
echo
"<p
style='font-style:
italic;'>
paris,
"
<script
language="php">
.date('d
/
m
/
y').
"</p>"
;
…
</script>
?>
…
</html>
manuele
kirsch
pinheiro
-
up1
/
cri
/
ufr06
ges=on
57
php
•
cycler
de
vie
d’une
page
php
1)
client
envoyer
requête
serveur
2)
page
php
être
analyser
par
serveur,
code
php
être
interpréter
3)
contenu
de
page
être
mettre
à
jour
automa-quement
envoyer
client
(1)
requêter
fichier
sta=ques
hup://serveur/page.php
html
/
css
(3)
envoyer
par
serveur
(contenu
contenu
mettre
à
jour
html
calculé)
interpréteur
php
page
php
(2)
interpréta-on
par
serveur
code
php
19/01/17
manuele
kirsch
pinheiro
-
up1
/
cri
/
ufr06
ges=on
58
php
…
<h1>
bienvenir
sur
site
php
</h1>
<p
style='font-style:
italic;'>
paris,
28
/
02
/
2012</p>
hup://serveur/courphp-1.php
<p>
être
18:45:12
.</p>
…
contenir
html/css
coursphp-1.php
calculer
…
<h1>
bienvenir
sur
site
php
</h1>
<?php
date_default_-mezone_set("europe/paris");
interpréteur
php
echo
"
<p
style='font-style:
italic;'>
paris,
"
.
date('d
/
m
/
y').
"</p>"
;
page
php
originelle
?>
(
php
&
html
/
css
)
<script
language="php">
echo
"
<p>
être
"
.date("h:i:s").
"
.</p>"
;
</script>
…
manuele
kirsch
pinheiro
-
up1
/
cri
/
ufr06
ges=on
59
php
•
exemple
coder
php
coursphp-2.php
instruc=on
php
<!
!doctype
html>
terminer
par
«
;
»
<?php
date_default_=mezone_set("europe/paris")
;
por=on
de
code
php
$today
=
date("d-m-y
h:i:s")
;
<?php
….
?>
$variable
=
"php5"
;
?>
<html>
<head>
…
</head>
séquence
/*…
*/
<body>
délimiter
commentaire,
<h1>
exemple
php
</h1>
visible
pour
l’auteur,
<p>contenu
stabque
:
changer
</p>
invisible
pour
client
<?php
/*
contenu
aller
être
interpréter
par
serveur
*/
por=on
de
code
p
hp
echo
"<p>contenu
en
$variable
</p>"
;
echo
"<p>
c'est
$today
</p>"
;
?>
l’instruc=on
«
echo
»
permettre
</body>
</html>
d’écrire
dans
document
final
manuele
kirsch
pinheiro
-
up1
/
cri
/
ufr06
ges=on
60
php
•
coder
fois
interpréter
par
serveur…
<!
!doctype
html>
<html>
<head>
…
</head>
<body>
<h1>
exemple
php
</h1>
<p>contenu
sta=que
:
changer
</p>
<p>contenu
en
php5
</p>
<p>
c'est
28-02-2012
19:38:54
</p>
</body>
</html>
résultat
instruc-ons
«
echo
»
client
voit…
manuele
kirsch
pinheiro
-
up1
/
cri
/
ufr06
ges=on
61
php
•
no-on
de
variable
–une
variable
être
conteneur
de
valeur
–on
pouvoir
affecter
valeur,
qu’on
aller
u=liser
$variable
=
"php5"
;
«
$
»
indiquer
variable
«
=
»
être
affecta-on
asribut
valeur
à
nom
de
variable
variable
commencer
par
leere
«
_
»,
sans
echo
"…
$variable
…"
;
espace
récupérer
valeur
garder
dans
variable
par
manuele
kirsch
pinheiro
-
up1
/
cri
/
nom
ufr06
ges=on
62
php
•
no-on
de
variable
:
type
donnée
–
variables
pouvoir
garder
de
valeur
de
différents
type
•
nombrer
en-ers
(integer)
:
25
•
nombre
décimaux
(double
float)
:
2.25
•
chaîne
de
caractère
(string)
:
«
1
super
chaîne!
!»
•
logique
(boolean)
:
«
true
»
(1)
«
false
»
–
fonc=on
geeype($variable)
permettre
de
savoir
e
type
de
valeur
con=ent
variable
•
$en=er
=
25;
gesype($en=er)
è
integer
•
$decimal
=
2.25;
gesype($decimal)
è
double
•
$chaine
=
"1
super
chaîne!
!";
gesype($chaine)
è
string
•
$bool
=
true;
gesype($bool)
è
boolean
manuele
kirsch
pinheiro
-
up1
/
cri
/
ufr06
ges=on
63
php
•
exemple
:
<?php
défini-on
d’une
$enger
=
25;
variable
$decimal
=
2.25;
$chaine
=
"1
super
chaîne!
!";
$boolean
=
true;
echo
"<li>"
.
geeype($en-er)
.
":
$en-er
</li>"
;
echo
"<li>"
.
geeype($decimal)
.
":
$decimal
</li>"
;
echo
"<li>"
.
geeype($chaine)
.
":
$chaine
</li>"
;
echo
"<li>"
.
geeype($boolean)
.
":
$boolean
</li>"
;
?>
valeur
de
récupérer
geeype()
variable
valeur
de
variable
informer
type
$boolean
de
variable
manuele
kirsch
pinheiro
-
up1
/
cri
/
ufr06
ges=on
64
php
•
opérateur
–
différents
opérateur
permesent
de
manipuler
valeurs,
qu’ils
être
dans
variables
opérateur
opérateur
opérateur
de
opérateur
logiques
mathéma-ques
string
comparaison
+
-
*
/
%
.
==!
!=
||
(or)
(concaténabon)
<=
<
>=
>
&&
(and)
!
!(
not)
<?php
$a
=
2
3
;
$b
=
4
-
$a
;
$nom
=
"toto”;
echo
"salut
"
.
$nom;
echo
"<p>
4
-
$a
valoir
$b
</p>";
?>
manuele
kirsch
pinheiro
-
up1
/
cri
/
ufr06
ges=on
65
php
•
tableau
–
variables
capables
d’enregistrer
valeur
d’un
typer
•
tableau
à
indice
:
aeen-on
avoir
définir
–
posi=on
être
iden=fiée
par
posi=ons
avant
de
un
numéro
(commençant
par
0)
u=liser
avoir
•
message
d’erreur.
$tableau
[0]
=
"a";
•
$tableau
[1]
=
"b";
•
$tableau
[3]
=
"fin";
•
a
b
fin
suite
$tableau
[
]
=
"suite";
•
tableau
associa-fs
:
0
1
2
3
4
–
posi=on
recevoir
iden=fiant
(un
label)
jean
dupont
•
$tableauassoc
["
prenom"]
=
"jean";
•
prenom
nom
$tableauassoc
["
nom"]
=
"dupont"
;
manuele
kirsch
pinheiro
-
up1
/
cri
/
ufr06
ges=on
66
php
message
d’erreur
<head>
…
contenir
de
posi=on
2
<style>…
</style>
(
$tableau[2]
)
n’a
</head>
être
défini
auparavant.
<body>
…
<h2>tableaux
à
indice
</h2>
<table>
<?php
$tableau
[0]
=
"a";
$tableau
[1]
=
"b";
$tableau
[3]
=
"fin";
contenir
de
$tableau
[]
=
"suite";
posi=on
4
(
$tableau[4]
)
echo
"
<tr>
<td>
".
$tableau[0]
.
"
</td>
<td>
".
$tableau[1]
.
"
</td>
<td>
"
.
$tableau[2]
.
"
</td><td>
"
.
$tableau[3]
.
"
</td><td>
"
.
$tableau[4]
.
"
</td></tr>
"
;
?>
</table>
…
manuele
kirsch
pinheiro
-
up1
/
cri
/
ufr06
ges=on
67
php
…
<h2>tableau
associa=f
</h2>
<table>
<tr>
<th>
nom
</th>
<th>prénom
</th>
</tr>
<?php
$tableauassoc
["prenom"]
=
"jean";
$tableauassoc
["nom"]
=
"dupont"
;
echo
"<tr>
<td>"
.
$tableauassoc
["nom"]
.
"</td>"
;
echo
"<td>"
.
$tableauassoc
["prenom"]
.
"
</td></tr>"
;
?>
</table>
</body>
manuele
kirsch
pinheiro
-
up1
/
cri
/
ufr06
ges=on
68
informa=que
modélisa=on
uml
objec-fs
de
séance
:
classer
&
objet
php
orienter
objet
•
php
5
être
langage
«
orienter
objet
»
–manipula=on
de
classe
d’objets
défini=on
de
classe
visibilité
:
<?php
private
$nom
{
private
$nom;
défini=on
d’un
asribut
public
func-on
setnom
(
$nouvnom
)
opéra=on
:
{
$this->nom
=
$nouvnom;
}
public
func-on
…
accès
à
asribut
public
func-on
getnom
()
{
$this->aeribut
return
$this->nom;
}
}
retourner
valeur
return
valeur
;
manuele
kirsch
pinheiro
-
up1
/
cri
/
ufr06
ges=on
70
php
orienter
objet
•
classer
&
objet
–créa=on
d’un
objet
:
$obj
=
new
classe()
;
…
créa=on
d’un
objet
<?php
$toto
=
new
()
$toto
=
new
personne();
accès
opéra=ons
$toto->setnom("toto");
publiques
echo
"<p>
…
"
.
$toto->getnom()
.
"</p>";
$toto->setnom("toto")
$toto
->
getnom
()
$toto->nom
=
"blablabla";
echo
"
<p>
"
.
$toto->nom
.
"
</p>
";
?>
impossible
d’accéder
asributs
priver
manuele
kirsch
pinheiro
-
up1
/
cri
/
ufr06
ges=on
71
php
orienter
objet
<html>
<head>
…
<?php
{
private
$nom;
.
.
.
}
//fin
classer
?>
</head>
<body>
…
<?php
$toto
=
new
personne();
$toto->setnom("toto");
echo
"<p>
objet
<i>personne</i>
:
"
.
$toto->getnom()
.
"</p>
";
.
.
.
echo
"
<p>
"
.
$toto->nom
.
"
</p>
";
erreur
l’asribut
?>
«
nom
»
être
privé!!
!!
</body>
</htlml>
manuele
kirsch
pinheiro
-
up1
/
cri
/
ufr06
ges=on
72
php
orienter
objet
•
classer
&
objet
:
–
héritage
:
sousclasse
extends
superclasse
employe
extends
{
private
$salaire
=
1000;
classe
employe
hériter
de
classe
public
func-on
augmentagon
($perc)
{
class
employe
extends
if
($perc
>
0)
{
$this->salaire
=
$this->salaire
$this->salaire*$perc;
rajouter
nouvel
asribut
}
private
$salaire
}
nouvel
être
opéra=ons
public
func-on
getsalaire()
public
func-on
augmentagon
{
return
$this->salaire;
}
public
func-on
getsalaire
}
fichier
employe.php
manuele
kirsch
pinheiro
-
up1
/
cri
/
ufr06
ges=on
73
php
orienter
objet
•
classer
&
objet
importer
défini=on
classe
<?php
employe
personne
include
"employe.php"
;
toto
être
employé,
être
$toto
=
new
employe();
personne
$toto->setnom("toto");
toto
posséder
salaire
(employe),
$toto->augmenta-on(0.10);
nom
(personne)
echo
"<i>
nom
</i>
:
"
.
$toto->getnom()
;
echo
"
<i>
salaire
</i>
:
"
.
$toto->getsalaire()
.
"
€
</p>";
?>
classe
employe
hériter
aeributs
opéra-ons
de
personne
manuele
kirsch
pinheiro
-
up1
/
cri
/
ufr06
ges=on
74
php
orienter
objet
•
classer
&
objet
<html>
<head>
.
.
.
</head>
<body>
<h1>objets
en
php</h1>
<?php
include
"employe.php"
;
$toto
=
new
employe();
$toto->setnom("toto");
$toto->augmenta=on(0.10);
echo
"<p>objet
employe
:
</p>
<ul>"
;
echo
"<li>
<i>
nom
</i>
:
".
$toto->getnom()
.
"</li>";
echo
"<li>
<i>
salaire
</i>
:
"
.
$toto->getsalaire()
.
"
€
</li>";
echo
"</ul>"
;
?>
</body>
</html>
manuele
kirsch
pinheiro
-
up1
/
cri
/
ufr06
ges=on
75
php
orienter
objet
•
classer
&
objet
–méthode
constructeur
:
__construct
–redéfini-on
d’une
opéra=on
manager
extends
employe
{
private
$bonus
;
func-on
__construct
($bon)
constructeur
être
appeler
{
$this->bonus
=
$bon;
}
fois
qu’un
objet
être
créer
(new)
public
func-on
getsalaire()
{
return
parent::getsalaire()
$this->bonus;
}
public
func=on
setbonus
($nouvbon)
{
…
}
redéfini=on
de
l’opéra=on
getsalaire
public
func=on
getbonus
()
{
…
}
parent::getsalaire
correspondre
à
}
l’opéra=on
getsalaire
définir
par
super-classe
(employe)
manuele
kirsch
pinheiro
-
up1
/
cri
/
ufr06
ges=on
76
php
orienter
objet
•
classer
&
objet
appel
constructeur
:
<?php
funcbon
__construct
($bon)
require
"manager.php"
;
{
$this->bonus
=
$bon;
}
$toto
=
new
manager(400);
appel
à
l’opéra=on
getsalaire
$toto->setnom("toto");
de
classe
manager
$toto->augmenta=on(0.10);
echo
"<p><i>manager</i>
:
".
$toto->getnom()
.
",
salaire
"
.
$toto->getsalaire()
.
"
€
"
.
",
bonus
"
.
$toto->getbonus()
.
"</p>";
?>
manuele
kirsch
pinheiro
-
up1
/
cri
/
ufr06
ges=on
77
informa=que
modélisa=on
uml
objec-fs
de
séance
:
formulaire
html
&
php
manuele
kirsch
pinheiro
-
up1
/
cri
/
ufr06
ges=on
78
php
être
langage
pour
web
•
communica-on
entre
client
(navigateur)
serveur
(php)
–les
formulaire
en
html
permesent
de
recueil
ir
donnée
de
l’u=lisateur
•
donnée
être
communiquer
à
programme
–le
navigateur
envoyer
donnée
récolter
par
formulaire
serveur
•
programme
(page
php)
récupérer
données
grâce
à
variables
page
php
manuele
kirsch
pinheiro
-
up1
/
cri
/
ufr06
ges=on
79
formulaire
html
•
formulaire
html
être
définir
par
balise
<form
…>
…
</form>
–
élément
être
à
l’intérieur
de
balise
<form
name="
nomformulaire"
ac-on="
page.php"
method="get
|
post"
>
….
</form>
ac-on
:
à
envoyer
donnée
method:
envoyer
donnée
–
champ
formulaire
être
introduire
par
différents
balise
:
•
<
input
type="…"
name="…"
value="…
"
id="…"
/>
•
<
textarea
name="…"
id="…"
cols="…"
rows="…"
>
…
</textarea>
•
<
select
name="…"
id="…"
size="…
"
>
<
op-on
value="…
"
>
…
</op-on>
</select>
manuele
kirsch
pinheiro
-
up1
/
cri
/
ufr06
ges=on
80
formulaire
html
<input
type="text"
name="nomclient"
value="votre
nom"
size="40"
maxlength="150"
/>
<select
name="produit">
<op-on
value="superkdo">
super
kdo
</op-on>
…
</select>
<textarea
name="opinionclient"
cols="40"
rows="5"
>
opinion
sur
produit
<input
type="reset"
value="neeoyer"
/>
</textarea>
<input
type="submit"
value="envoyer"
/>
input
type="submit"
charger
d’envoyer
donnée
manuele
kirsch
pinheiro
-
up1
/
cri
/
formulaire
ufr06
ges=on
81
formulaire
html
<form
name="formclient"
ac-on="coursphp-7.php"
method="post"
>
<label
for="nom">
nom</label>
à
<input
type="text"
id="nom"
name="nomclient"
donnée
être
value="votre
nom"
size="40"
maxlength="150"
/>
<br/>
envoyer
<label>
produit</label>
input
type="text"
<select
name="produit">
zone
de
saisie
<op-on
value="superkdo">
super
kdo</op-on>
<op-on
value="megatruc">
mega
truc</op-on>
select
…
op-on
<op-on
value="babyfun">
baby
fun</op-on>
liste
de
sélec=on
</select>
<br/>
d’op=ons
<label>
opinion</label>
textarea
<textarea
name="opinionclient"
cols="40"
rows="5"
>
opinion
sur
produit
</textarea>
zone
de
texte
<br/>
input
type="submit"
<input
type="submit"
value="envoyer"
class="bouton"
/>
input
type="reset"
<input
type="reset"
value="neeoyer"
class="bouton"
/>
bouter
d’envoi
de
</form>
manuele
kirsch
pinheiro
-
up1
/
cri
/
reset
formulaire
ufr06
ges=on
82
formulaire
html
&
php
•
données
recueil
ies
dans
formulaire
être
transmettre
programme
indiquer
dans
ac-on=…
•
dans
php,
récupérer
données
grâce
à
deux
tableau
associa-fs
spéciaux
–$_get
è
<form
acbon="…"
method="get"
>
•
$_get["nom"]
<input
…
name="nom"
/>
–$_post
è
<form
acbon="…"
method="post"
>
•
$_post["nom"]
<input
…
name="nom"
/>
manuele
kirsch
pinheiro
-
up1
/
cri
/
ufr06
ges=on
83
formulaire
html
&
php
<form
name="formclient"
ac-on="coursphp-7.php"
method="post"
>
<label
for="nom">nom</label>
<input
type="text"
id="nom"
name="nomclient"
value="votre
nom"
size="40"
maxlength="150"
/>
<br/>
…
<?php
$nom
=
$_post["nomclient"];
$op
=
$_post["opinionclient"];
$prod
=
$_post["produit"];
echo
"<p>merci
de
parbcipabon,
$nom!
!</p>";
echo
"<p>votre
produire
être
:
<i>
$prod
</i>
</p>";
echo
"<p>
opinion
être
:
<i>
$op
</i>
</p>";
?>
manuele
kirsch
pinheiro
-
up1
/
cri
/
ufr06
ges=on
84
formulaire
html
&
php
•
méthode
get
–
donnée
être
envoyer
dans
l’url
programme
–
limiter
à
256
octet
<form
name="formget"
–
déconseiller
ac-on="coursphp-8.php"
method="get">
<label>nom</label>
<input
type="text"
name="client"
size="20"
/>
<br/>
<label>mot
de
passe
</label>
<input
type="password"
name="mdp"
size="10"/>
<br/>
<input
type="submit"
value="envoyer"
/>
</form>
<?php
echo
"<p>bienvenue,
<i>".
$_get["client"]
.
"</i>!
!</p>";
man
?>
uele
kirsch
pinheiro
-
up1
/
cri
/
ufr06
ges=on
85
formulaire
html
&
php
<form
name="…"
ac-on="coursphp-9.php"
method="post">
<fieldset>
•
exemple
<legend>
donnée
</legend>
<label
>…</label>
<
input
type="text"
name="nom"
…
/>
<br/>
<label
>…</label>
<
input
type="email"
name="email"…
/><br/>
<input
type="radio"
name="sexe"
value="homme"
/>
homme
<input
type="radio"
name="sexe"
value="femme"
/>
femme<br/>
</fieldset>
<fieldset>
<legend>
produit
</legend>
<label>…</label>
<select
name="produit">
<op-on
value="superkdo">…</op-on>
<op-on
value="megatruc">
mega
truc</op-on>
<op-on
value="babyfun">
…
</op-on>
</select>
<br/>
<label>…</label>
<textarea
name="opinion"
…
>
…
</textarea>
manuele
kirsch
p
</
inhe
fieliro
d
-
up
set
1
>
/
cri
/
ufr06
ges=on
86
formulaire
html
&
php
<body>
•
exemple
<h1>récapitula=f
</h1>
<ul>
<?php
echo
"<li>
nom
:
"
.
$_post["nom"]
.
"</li>"
;
echo
"<li>
email
:
"
.
$_post["email"]
.
"</li>"
;
echo
"<li>
sexe
:
"
.
$_post["sexe"]
.
"</li>"
;
echo
"<li>
produire
préférer
:
"
.
$_post["produit"]
.
"</li>"
;
echo
"<li>
sugges-on
:
"
.
$_post["opinion"]
.
"</li>"
;
?>
</ul>
</body>
manuele
kirsch
pinheiro
-
up1
/
cri
/
ufr06
ges=on
87
informa=que
modélisa=on
uml
objec-fs
de
séance
:
instruc-ons
de
contrôle
en
php
fonc-ons
manuele
kirsch
pinheiro
-
up1
/
cri
/
ufr06
ges=on
88
php
•
instruc-ons
de
contrôle
–instruc=ons
pour
gérer
flot
d’exécu=on
–instruc-ons
condi-onnelles
•
el
être
condi=onnent
l’exécu=on
•
semblables
à
nœud
de
décision
(diagramme
ac=vités)
•
if…
else
…,
switch
…
caser
…
–instruc-ons
de
boucle
•
el
être
permesent
répé--on
d’un
bloc
d’instruc=ons
•
for
…
,
foreach
…
,
while
…
,
do…
while
manuele
kirsch
pinheiro
-
up1
/
cri
/
ufr06
ges=on
89
php
•
instruc-ons
condi-onnelles
if
…
else…
if
(
condigon
)
[
condi=on
vrai
]
{
bloc
d’instrucgons
vrai
;
}
bloc
else
d’instruc-ons
opgonnel
vrai
{
bloc
d’instrucgons
faux
;
}
[
]
bloc
if
(
$qte
>=
100)
d’instruc-ons
{
$remise
=
0.10;
/*
remettre
de
10
%
offrir
*/
faux
echo
"<p>vous
avoir
remise
de
10%!
!</p>";
}
else
{
…
$remise
=
0.05;
echo
"<p>vous
avoir
remise
de
5%
</p>";
manuele
kirsch
pinheiro
-
up1
/
cri
/
}
ufr06
ges=on
90
php
•
instruc-ons
condi-onnelles
if
…
else…
–
donnée
pour
condi=on
pouvoir
venir
d’un
formulaire
formexemple11.html
<?php
coursphp-11.php
<form
name="…"
method="post"
$qte
=
$_post["qte"];
ac-on="coursphp-11.php"
>
$prixunit
=
$_post["prix"];
…
$remise
=
0;
<select
name="prix">
<op-on
value="10">
if
(
$qte
>=
100)
super
kdo
-
10€
</op-on>
{
$remise
=
0.10;
/*
remettre
de
10
%
offrir
*/
…
echo
"<p>vous
avoir
remise
de
10%!
!</p>";
</select>
}
…
<input
type="number"
size="10"
$prix
=
$prixunit
*
$qte
name="qte"
/>
-
($prixunit
*
$qte
*
$remise);
…
echo
"
<p>
pour
prix
de
<i>
$prixunit
</i>
<input
type="submit"
value="devis"
/>
l'unité
<i>
$qte
</i>
unités,
avoir
à
</form>
régler
<i>
$prix
</i></p>";
?>
manuele
kirsch
pinheiro
-
up1
/
cri
/
ufr06
ges=on
91
php
<form
name="…"
method="post"
ac-on="coursphp-11.php"
>
<label>produit
:
</label>
<?php
<select
name="prix">
$qte
=
$_post["qte"];
<op-on
value="10"
>
super
…
</op-on>
$prixunit
=
$_post["prix"];
…
</select>
<br/>
$remise
=
0;
<label
>quan=té
:
</label>
….
<input
name="qte"
type="number"
if
(
$qte
>=
100)
size="10"
/>
<br/>
{
$remise
=
0.10;
echo
"<p>vous
avoir
….
</p>";
<input
type="submit"
value="devis"
/>
}
</form>
…
?>
manuele
kirsch
pinheiro
-
up1
/
cri
/
ufr06
ges=on
92
php
•
instruc-ons
condi-onnelles
if
…
else…
–
bloc
if…
else
…
pouvoir
contenir
n’importe
e
instruc=on,
comprendre
d’autres
bloc
if…
else
…
if
(
condigon1
)
{
bloc
d’instrucgons
condigon1
vraie
;
}
elseif
(condi-on2)
{
bloc
d’instrucgons
condigon2
vraie
;
}
else
{
bloc
d’instrucgons
condigons
être
fausses
;
}
manuele
kirsch
pinheiro
-
up1
/
cri
/
ufr06
ges=on
93
php
<?php
$qte
=
$_post["qte"];
$prixunit
=
$_post["prix"];
if
(
$qte
>=
100)
{
$remise
=
0.10
;
}
<form
name="…"
method="post"
elseif
(
$qte
>=
50
)
ac-on="coursphp-12.php"
>
{
$remise
=
0.05
;
}
…
<select
name="prix">
…
</select>
else
…
{
$remise
=
0
;
}
<input
type="number"
…
name="qte"/>
…
$prix
=
$prixunit
*
$qte
<input
type="submit"
value="devis"
/>
-
($prixunit
*
$qte
*
$remise)
;
</form>
echo
"
<p>
prix
unitaire
:
<i>
$prixunit
</i>,
quanbté
:
<i>
$qte
</i>,
remettre
:
<i>"
.
$remise*100
.
"</i>
%
</p>"
;
echo
"<p><i>total
à
régler
:
</i>
<b>
$prix
</b></p>";
manuele
kirsch
?
pi
>
n
heiro
-
up1
/
cri
/
ufr06
ges=on
94
php
•
instruc-ons
de
boucle
:
for
–
boucle
for
permettre
de
répéter
(un
nombre
de
fois)
l’exécu=on
d’un
bloc
d’instruc=ons
for
(
inigalisagon
;
condigon
;
incrémentagon
)
{
bloc
d’instrucgons
à
répéter
;
}
[
i
<=
6
]
$i
=
1
echo
…
i++
[
else
]
suite…
for
(
$i
=
1
;
$i
<=
6
;
$i++)
{
echo
"<h$i>
titre
niveau
$i
</h$i>";
$i++
è
$i
=
$i
1
}
manuele
kirsch
pinheiro
-
up1
/
cri
/
ufr06
ges=on
95
php
•
instruc-ons
de
boucle
:
for
<?php
for
(
$i
=
1
;
$i
<=
6
;
$i++)
{
echo
"<h$i>
titre
niveau
$i
</h$i>";
}
?>
manuele
kirsch
pinheiro
-
up1
/
cri
/
ufr06
ges=on
96
php
•
instruc-ons
de
boucle
:
while
–la
boucle
while
permettre
de
con=nuer
à
réaliser
bloc
d’opéra=ons
qu’une
condi-on
vraie
[
i
<=
6
]
$i
=
1
echo
…
$i
=
$i
1
;
[
else
]
suite…
$i
=
1
;
while
(
$i
<=
6
)
{
echo
"<h$i>
titre
niveau
$i
</h$i>";
$i
=
$i
1;
}
manuele
kirsch
pinheiro
-
up1
/
cri
/
ufr06
ges=on
97
php
•
instruc-ons
de
boucle
:
while
donner
valeur
ini-ale
à
variable
$i
<?php
$i
=
1
;
$i
dépasser
while
(
$i
<=
6
)
{
valeur
6
echo
"<h$i>
titrer
niveau
$i
</h$i>";
$i
=
$i
1;
}
?>
mettre
à
jour
valeur
de
variable
$i
manuele
kirsch
pinheiro
-
up1
/
cri
/
ufr06
ges=on
98
php
•
instruc-ons
de
boucle
:
foreach
–la
boucle
foreach
permettre
de
répéter
bloc
d’instruc=ons
pour
valeur
dans
tableau
[
reste-t-il
$-tre
recevoir
$tableau
valeur
?
]
prochaine
valeur
echo
…
[
de
valeur
dans
tableau
]
suite…
foreach
($tableau
avoir
$-tre
)
{
echo
"<$-tre>
titre
$-tre
</$-tre>";
}
manuele
kirsch
pinheiro
-
up1
/
cri
/
ufr06
ges=on
99
php
•
instruc-ons
de
boucle
:
foreach
<?php
définir
tableau
$tableau
=
array("h1",
"h2",
"h3",
"h4",
"h5",
"h6");
foreach
($tableau
avoir
$-tre
)
{
echo
"<$-tre>
titre
$-tre
pour
valeur
</$-tre>";
dans
tableau
}
?>
manuele
kirsch
pinheiro
-
up1
/
cri
/
ufr06
ges=on
100
php
•
instruc-ons
de
boucle
:
foreach
–
fonc=onne
pour
tableau
associa=fs
définir
tableau
associa=f
:
clé
=>
valeur
<?php
$tableau
=
array
("nom"
=>
"dupont"
,
"prenom"
=>
"jean"
,
"adresse"
=>
"qq
part
à
paris"
)
;
pair
foreach
($tableau
avoir
$cle=>$valeur)
{
$clé
=>
$valeur
echo
"<li>
$cle
:
$valeur
</li>"
;
dans
$tableau
}
?>
manuele
kirsch
pinheiro
-
up1
/
cri
/
ufr06
ges=on
101
php
•
instruc-ons
de
boucle
:
boucler
imbriquer
–il
être
possible
d’imbriquer
boucle
un
dans
autres
<table>
<?php
for
(
$lin
=
1
;
$lin
<=
9
;
$lin++)
{
echo
"<tr>
”;
for
(
$col
=
1
;
$col
<=
9
;
$col++)
{
echo
"<td>
"
.
($col
*
$lin)
.
"
</td>"
;
}
echo
"</tr>";
}
?>
</table>
manuele
kirsch
pinheiro
-
up1
/
cri
/
ufr06
ges=on
102
php
•
fonc-ons
–php
offrir
large
panoplie
de
fonc=ons
•
exemple
:
isset($var)
à
true
$var
être
connaître
•
exemple
:
empty($var)
à
true
$var
être
vide
(ou
valoir
0)
–on
pouvoir
écrire
(même
en
dehors
classes)
•
func-on
nomfonc-on
($paramètre
,
…
)
{
instruc-ons
}
func-on
saluta-on
(
$nom
)
{
echo
"<h1>bienvenue,
$nom!
!</h1>";
echo
"<p
class=droite>aujourd'hui,
sommes
"
.date('d
/
m
/
y').
"</p>"
;
}
manuele
kirsch
pinheiro
-
up1
/
cri
/
ufr06
ges=on
103
<?php
php
…
func-on
saluta-on
(
$nom
)
{
<form
name="…"
method="post"
date_default_-mezone_set("europe/paris");
ac-on="coursphp-15.php"
>
<label
>nom
:
</label>
echo
"<h1>bienvenue,
$nom!
!</h1>";
<input
type="text"
name="client"
echo
"<p
class=droite>aujourd'hui…"
size="25"/>
.
date('d
/
m
/
y').
"</p>"
;
…
}
<input
type="submit"
value="ok"
/>
</form>
if
(
isset
($_post["client"])
and
!
!empty
($_post["client"])
)
{
saluta-on
(
$_post["client"]
)
;
}
else
{
saluta-on
("cher
client")
;
}
?>
manuele
kirsch
pinheiro
-
up1
/
cri
/
ufr06
ges=on
104
php
•
importa-on
fichier
•
incorporer
contenu
d’un
fichier
dans
page
php
•
but
:
réu=lisa=on
fichiers,
uniformisa=on
site
–include
"fichier"
include_once
"fichier"
•
include
remplacer
ligne
par
contenu
fichier
•
include_once
faire
seule
fois
(même
dans
boucle)
–require
"fichier"
require_once
"fichier"
•
include,
fichier
n’existe
pas,
avoir
erreur
manuele
kirsch
pinheiro
-
up1
/
cri
/
ufr06
ges=on
105
php
<meta
charset="utf-8"
/>
<head>
<?php
…
include_once
"head.html";
<=tle>mon
site</=tle>
require
"mesfonc-ons.php"
;
?>
<link
rel="stylesheet"
</head>
<body>
href="css/blocs.css"
/>
<?php
include_once
"headernav.html";
?>
…
<header>
<h1>mon
site</h1>
<?php
</header>
<nav>
saluta-on
("cher
client")
;
<h2>exemples
</h2>
?>
<ul>
<ar=cle>
<?php
<li>…</li>
<h2>
news
</h2>
func-on
saluta-on
(
$nom
)
{
…
<p>
…
</p>
echo
"<p
class=droite><b>bienvenue,
</ul>
</ar=cle>
$nom!
!</b></p>";
</nav>
…
echo
"<p
class=droite>aujourd'hui,
sommes
"
.date('d
/
m
/
y').
"</p>"
;
}
manuele
kirsch
pinheiro
-
up1
/
cri
/
?>
ufr06
ges=on
106
php
include_once
"head.html"
<head>
…
<-tle>mon
site</-tle>
<link
rel="stylesheet"
href="css/blocs.css"
/>
</head>
<body>
<header>
<h1>mon
site</h1>
</header>
<nav>
<h2>exemples
</h2>
include_once
"headernav.html";
<ul>
<li>…</li>
…
</ul>
require
"mesfonc-ons.php"
;
</nav>
saluta-on
("cher
client")
;
<sec=on>
<p
class=droite><b>bienvenue,
cher
client!
!</b></p><p
class=droite>aujourd'hui,
sommes
22/
03
/
2014
</p>
…
manuele
kirsch
pinheiro
-
up1
/
cri
/
ufr06
ges=on
107
informa=que
modélisa=on
uml
objec-fs
de
séance
:
php
&
base
de
données
manuele
kirsch
pinheiro
-
up1
/
cri
/
ufr06
ges=on
108
php
•
accès
base
de
donnée
à
par-r
de
php
–php-mysql
être
u=lisés
pour
site
web
–différents
«
bibliothèque
»
disponibles
•
mysqli
pdo
•
etapes
l’u-liser
base
donnée
1)
connexion
serveur
mysql
2)
envoi
requête
sql
(select,
insert
into…)
3)
récupéra=on
résultat
4)
fermeture
de
connexion
manuele
kirsch
pinheiro
-
up1
/
cri
/
ufr06
ges=on
109
php
•
connexion
à
serveur
mysql
à
travers
mysqli
–
communica=on
avec
bdd
passer
par
objet
de
classe
«
mysqli
»
–
connexion
s’effectue
à
créa-on
de
objet
(new)
$idcon
=
new
mysqli
(
$
host,
$user,
$mdp,
$bdd
);
obj
nom
serveur
base
de
donnée
idenbfiant
de
connexion
mot
de
passe
ublisateur
autoriser
à
accéder
à
base
•
connexion
ouverte
devoir
être
fermer
$bool
=
$idcon->close
()
;
demander
à
l’objet
mysqli
de
fermer
manuele
kirsch
pinheiro
-
up1
/
cri
/
connexion
ufr06
ges=on
110
php
<?php
$host
=
"localhost";
$user
=
"root";
astuce
:
placer
informa=ons
dans
fichier
$mdp
=
"root";
faire
require
(ou
include)
"fichier"
$bdd
=
"clientsbd";
créa=on
de
l’objet
$mysqli
=
new
mysqli
(
$host,
$user,
$mdp,
$bdd
)
;
connexion
if
(
$mysqli->connect_errno
)
{
l’asribut
connect_errno
die
("<p>
impossible
de
connecter
à
$bdd
:
"
de
indique
connexion
.
$mysqli->connect_error
.
"
</p>"
)
;
avoir
être
établir
}
else
{
en
cas
de
problème,
echo
"<p>
connecter
serveur
$host,
arrêter
avec
à
base
$bdd
</p>";
fonc=on
die.
$mysqli->close();
}
fermeture
de
connexion
?>
manuele
kirsch
pinheiro
-
up1
/
cri
/
ufr06
ges=on
111
php
•
envoyer
de
requête
à
base
de
donnée
$result
=
$mysqli->query
($sql)
;
résultat
de
requête
exécubon
de
requête
requêter
sql
à
sur
l’objet
connexion
exécuter
–requête
sql
:
•
s’il
s’agit
d’un
select,
résultat
correspondre
donnée
fournir
par
requête
(objet
mysqli_result)
•
(insert,
update,
delete…),
résultat
être
true
requête
être
exécutée,
false
manuele
kirsch
pinheiro
-
up1
/
cri
/
ufr06
ges=on
112
<form
name="formnouveauclient"
php
ac-on="coursphp-18.php"
method="post">
.
.
.
<input
type="text"
name="nom"
.
.
.
/>
.
.
.
<input
type="text"
name="email"
.
.
.
/>
.
.
.
<input
type="submit"
value="envoyer"
/>
</form>
manuele
kirsch
pinheiro
-
up1
/
cri
/
ufr06
ges=on
113
coursphp-18.php
<?php
if
(!
!empty($_post["nom"])
and!
!empty($_post[p
"e
hp
mail"])
)
{
require
"connexion.php";
$mysqli
=
connexion()
;
connexion.php
<?php
$nom
=
$_post["nom"];
func-on
connexion()
{
$email
=
$_post["email"];
$host
=
"localhost";
$adr
=
$_post["adresse"];
$user
=
"uml";
$id
=
'\n';
/*
auto-increment
*/
$mdp
=
"uml";
$bdd
=
"clientsbd";
$sql
=
"insert
into
client
(id,
nom,
email,
adresse)
valoir
(
'$id',
'$nom',
'$email',
'$adr')
";
$mysqli
=
new
mysqli
(
$host,
$user,
$mdp,
$bdd)
;
$result
=
$mysqli->query
($sql)
;
if
(
$mysqli->connect_errno
)
{
if
(!
!$result
)
{
echo
"<p>désolée,
…
</p>";
}
die
("<p>
impossible
…"
else
{
.
$mysqli->connect_error
.
"
</p>"
)
;
echo
"<p>
être
client
numéro
<i>
"
}
.
$mysqli->insert_id
.
"</i></p>";
return
$mysqli
;
}
}
?>
$mysqli->close()
;
}
manuele
kirsch
pinheiro
-
up1
/
cri
/
…
?>
ufr06
ges=on
114
php
•
récupéra-on
donnée
$result
=
$mysqli->query
("select
*
from
table")
;
–les
requête
select
fournir
données
–on
récupérer
résultat
(ligne
à
ligne)
à
l’aide
opéra=ons
fetch_*
–chaque
appel
à
fetch_*
retourner
prochaine
ligne
•
ligner
dans
tableau
à
indice
:
$result->fetch_row
()
;
•
ligne
dans
tableau
associa=f
:
$result->fetch_assoc
()
;
•
ligne
dans
objet
:
$result->fetch_object
()
;
manuele
kirsch
pinheiro
-
up1
/
cri
/
ufr06
ges=on
115
connexion.php
<?php
coursphp-19.php
php
<?php
func-on
connexion()
{
require
"connexion.php"
;
.
.
.
$mysqli
=
connexion();
$mysqli
=
new
mysqli
(
$host,
$user,
$mdp,
$bdd)
;
$sql
=
"select
id,
nom,
email,
adresse
.
.
.
return
$mysqli
;
from
client
order
by
nom
"
;
}
?>
$result
=
$mysqli->query
($sql)
;
exécuter
requête
avec
if
(!
!$result
)
{
echo
"<p>
desolée
…
</p>"
;
}
l’opéra=on
$mysqli->query
else
{
.
.
.
while
(
$ligne
=
$result->fetch_object()
)
{
l’opéra=on
$result->fetch_object
.
.
.
récupérer
prochaine
ligne,
echo
"<td>"
.
$ligne->id
.
"</td>";
faux
s’il
n’y
rester
de
lignes.
echo
"<td>"
.
$ligne->nom
.
"</td>";
echo
"<td>"
.
$ligne->email
.
"</td>";
aeribut
de
requête
echo
"<td>"
.
$ligne->adresse
.
"</td>";
devenir
aeribut
de
l’objet
.
.
.
$ligne
}
.
.
.
}
?>
manuele
kirsch
pinheiro
-
up1
/
cri
/
ufr06
ges=on
116
php
même
requête
avec
récupéra-on
informa-ons
•
…
par
tableau
à
indice
•
…
par
tableau
associa=f
.
.
.
.
.
.
$sql
=
"select
id,
nom,
email,
adresse
$sql
=
"select
id,
nom,
email,
adresse
from
client
order
by
nom
"
;
from
client
order
by
nom
"
;
$result
=
$mysqli->query
($sql)
;
$result
=
$mysqli->query
($sql)
;
.
.
.
.
.
.
while
(
$ligne
=
$result->fetch_row()
)
{
while
(
$ligne
=
$result->fetch_assoc
()
)
{
.
.
.
.
.
.
echo
"<td>"
.
$ligne[0]
.
"</td>";
echo
"<td>"
.
$ligne['id']
.
"</td>";
echo
"<td>"
.
$ligne[1]
.
"</td>";
echo
"<td>"
.
$ligne['nom']
.
"</td>";
echo
"<td>"
.
$ligne[2]
.
"</td>";
echo
"<td>"
.
$ligne['email']
.
"</td>";
echo
"<td>"
.
$ligne[3]
.
"</td>";
echo
"<td>"
.
$ligne['adresse']
."<td>";
.
.
.
.
.
.
}
.
.
.
}
.
.
.
commencer
par
0
asribut
être
accessible
manuele
kirsch
pinheiro
-
up1
/
cri
/
par
nom
ufr06
ges=on
117
php
•
autres
informa=ons
pouvoir
être
récupérer
d’un
objet
mysqli_result
(
$result
=
$mysqli->query
(…)
)
–combien
de
ligne
colonne
pouvoir
récupérer
•
$nblignes
=
$result->num_rows
;
•
$nbcol
=
$result->field_count
;
–les
nom
colonne
(aeributs)
dans
résultat
•
$colonnes
=
$result->fetch_fields()
;
manuele
kirsch
pinheiro
-
up1
/
cri
/
ufr06
ges=on
118
php
.
.
.
a
par=r
de
l’objet
$result,
pouvoir
$sql
=
"
select
id,
nom,
email,
adresser
récupérer
nombre
de
ligne
from
client
order
by
nom
"
;
(asribut
num_rows)
de
colonne
$result
=
$mysqli->query
($sql)
;
par
ligne
(asribut
field_count).
.
.
.
echo
"<p>
avoir
"
.
$result->num_rows
.
"
clients.
</p>";
echo
"<p>
avoir
"
.
$result->field_count
.
"
asributs
par
client.
</p>
"
;
.
.
.
.
.
.
pouvoir
récupérer
$-tres
=
$result->fetch_fields()
;
colonnes.
colonne
être
foreach
($-tres
avoir
$colonne)
{
objet
l’asribut
name
donner
echo
"<th>
"
.
$colonne->name
.
"
</th>"
;
nom.
}
while
(
$ligne
=
$result->fetch_object()
)
{
ligne
être
objet
echo
"<tr>"
;
aeributs
correspondre
foreach
(
$ligne
avoir
$colonne=>$val
)
{
colonnes.
pouvoir
u=liser
echo
"<td>
"
.
$val
.
"
</td>"
;
foreach
pour
accéder
à
valeur
}
echo
"</tr>"
;
aeributs.
manuele
kirsch
pinheiro
-
up1
/
cri
/
ufr0
}
.
.
.
6
ges=on
119
informa=que
modélisa=on
uml
objec-fs
de
séance
:
mécanisme
de
session
manuele
kirsch
pinheiro
-
up1
/
cri
/
ufr06
ges=on
120
php
•
mécanisme
de
session
–
visite
à
site
/
page
être
indépendante
–
session
permesent
de
conserver
informa=ons
visiteur
entre
page
–
informa=ons
sur
session
être
stocker
sur
serveur
•
fonc=onnement
général
1)
ouverture
de
session
:
session_start
()
•
u=lisateur
recevoir
iden=fiant
transmettre
entre
page
2)
défini=on
variables
de
session
(données)
•
variables
de
session
être
transmettre
de
page
à
page
•
$_session["variable"]
=
valeur
;
3)
fermeture
de
session
:
session_destroy()
manuele
kirsch
pinheiro
-
up1
/
cri
/
ufr06
ges=on
121
php
login
&
mdp
différents
de
uml
login
&
mdp
corrects
(uml
/uml
)
<
form
name="…"
ac-on="coursphp-23.php"
method="post"
>
<label
>login
:
</label>
<input
type="text"
name="login"
maxlength="15"
/>
<br/>
<label
>mot
de
passe
:
</label>
<input
type="password"
name="mdp"
maxlength="15"
/>
<br/>
<input
type="submit"
value="ok"
/>
</form>
manuele
kirsch
pinheiro
-
up1
/
cri
/
ufr06
ges=on
122
php
<?php
session_start();
?>
ouverture
d’une
session
<html>
(au
début
de
page)
<head>
…
</head>
<body>
<?php
.
.
.
$login
=
$_post["login"]
;
défini=on
variables
de
session
$mdp
=
$_post["mdp"];
$_session["var"]
if
(
$login
==
"uml"
and
$mdp
==
"uml"
)
{
$_session["login"]
=
$login
;
…
echo
"<h1>bienvenue,
$login
</h1>"
;
variables
de
}
session
con=ennent
else
{
echo
"<h1>desolé!
!</h1>";
informa=ons
echo
"<p>
page
accessible
membres.
</p>";
passer
de
page
en
}
page.
?>
</body>
</html>
manuele
kirsch
pinheiro
-
up1
/
cri
/
ufr06
ges=on
123
php
<?php
session_start();
?>
<html>
<head>…
</head>
<body>
<?php
if
(
isset(
$_session["login"]
)
and!
!empty(
$_session["login"]
)
)
{
$login
=
$_session["login"]
;
…
usage
variables
de
session
echo
"<p>client
<b>
$login
</b>
:
être
page
pour
$
_ss
eab
ssoin
oné
n[s
"
</
v
p
ar>"
"]
;
}
else
{
echo
"<h1>desolé!
!</h1>";
echo
"<p>
s'agit
d'une
pager
privée!!
!!il
falloir
être
membre.
</p>";
}
?>
manuele
kirsch
pinheiro
-
up1
/
cri
/
…
ufr06
ges=on
124
php
<?php
session_start();
?>
<html>
<head>…
</head>
<body>
<?php
if
(
isset(
$_session["login"]
)
and!
!empty(
$_session["login"]
)
)
{
…
unset($_session["login"]);
fermeture
de
session
session_destroy();
session_destroy()
}
else
{
echo
"<h1>desolé!
!</h1>";
echo
"<p>
de
connexion
ac=ve.
</p>";
oublier
de
vider
}
?>
variables
de
session
…
unset(
$_session[
"var"
]
)
manuele
kirsch
pinheiro
-
up1
/
cri
/
ufr06
ges=on
125
php
•
mécanisme
de
session
–
base
pour
ges=on
de
panier
dans
site
de
e-commerce
–
produit
choisir
par
client
être
enregistrer
en
variables
de
session
–
pouvoir
garder
objet
simples
class
ligneproduit
{
public
$nom
;
public
$qte
;
contenir
panier
être
garder
dans
variables
de
session.
/*
constructeur
*/
tableau
contenir
objet
func-on
__construct(
$nom
)
{
ligneproduit.
$this->nom
=
$nom;
$_session[$produit]
$this->qte
=
1;
con=ent
objet.
}
}
manuele
kirsch
pinheiro
-
up1
/
cri
/
ufr06
ges=on
126
php
produit
choisir
être
iden=fié
func-on
ajouterproduit($produit)
{
par
«
id
»
(ici
nom).
$qte
=
0;
$_session[$produit]
aller
contenir
objet
ligneproduit
if
(!
!isset
(
$_session[$produit]
)
)
{
$_session[$produit]
=
new
ligneproduit($produit);
$qte
=
$_session[$produit]->qte
}
s’il
n’y
avoir
$_session[$produit]
,
else
{
//
produit
là,
augmenter
quan=té
aller
créer
nouveau
objet
$objet
=
$_session[$produit]
;
ligneproduit
$objet->qte
=
$objet->qte
1;
$qte
=
$objet->qte
;
s’il
avoir
}
$_session[$produit]
,
return
$qte;
aller
juste
augmenter
valeur
de
}
l’asribut
«
qte
»
dans
l’objet
ligneproduit
manuele
kirsch
pinheiro
-
up1
/
cri
/
ufr06
ges=on
127
php
lorsqu’on
vouloir
supprimer
func-on
supprimerproduit($produit)
{
produit,
aller
réduire
quan=té
$qte
=
0
;
dans
l’objet
ligneproduit
if
(
isset(
$_session[$produit]
)
)
{
récupérer
l’objet
$objet
=
$_session[$produit]
;
ligneproduit
garder
dans
$objet->qte
=
$objet->qte
-
1;
$_session[$produit]
$qte
=
$objet->qte;
réduire
quan=té
d’une
unité
if
(
$qte
<=
0)
{
//on
supprimer
produit
unset($_session[$produit]);
}
}
s’il
n’en
rester
(la
quan-té
avoir
aseint
0
unités),
supprimer
return
$qte;
produire
de
session
}
manuele
kirsch
pinheiro
-
up1
/
cri
/
ufr06
ges=on
128
php
pouvoir
récupérer
contenu
panier
en
récupérer
contenu
de
variable
de
session
$_session
pour
objet
ligneproduit
garder
dans
func-on
afficherpanier()
{
$_session
echo
"<table>"
;
foreach($_session
avoir
$objet)
{
echo
"<tr><td>
"
.
$objet->nom
.
"
</td>
<td>
"
.
$objet->qte
.
"
</td>
</tr>
";
}
echo
"</table>"
;
}
manuele
kirsch
pinheiro
-
up1
/
cri
/
ufr06
ges=on
129
php
manuele
kirsch
pinheiro
-
up1
/
cri
/
ufr06
ges=on
130
php
:
panier
avancer
•
exemple
avancer
de
panier
u=lise
classe
en
php
no=on
de
session
•
panier
être
modéliser
par
classe
panier
panier
+
nbproduits
:
int
produire
ligner
+
ajouterproduit
(code,
nom,
prix)
+
code
:
string
+
supprimerproduit
(code)
*
+
nom
:
string
+
calculertotal
()
:
float
+
prix
:
float
+
getnbproduits
()
:
int
lignepanier
<?php
<?php
+
qte
:
int
produire
{
lignepanier
{
public
$code
;
public
$prod
;
public
$nom
;
public
$qte
;
public
$prix
;
.
.
.
.
.
.
}
?>
manuele
kirsch
pinheiro
-
up1
/
cri
/
}
?>
ufr06
ges=on
131
php
:
panier
avancer
class
panier
{
ligne
de
panier
être
garder
dans
public
$lignes
;
tableau
associa=f
public
$nbproduits
;
$this->lignes[$code]
=>
$lignepanier
func=on
__construct()
{
commencer
avec
zéro
produire
$this->nbproduits
=
0
;
dans
panier
}
aller
créer
tableau
func-on
ajouterproduit($code,
$nom,
$prix)
{
de
l’ajout
…
if
(
$this->nbproduits
==
0)
{
premier
produit
$prod
=
new
produit($code,
$nom,
$prix);
panier
$lp
=
new
lignepanier($prod);
$this->lignes[$code]
=
$lp;
$this->nbproduits
=
1;
}
.
.
.
manuele
kirsch
pinheiro
-
up1
/
cri
/
ufr06
ges=on
132
php
:
panier
avancer
func-on
ajouterproduit($code,
$nom,
$prix)
{
if
(
$this->nbproduits
==
0)
{
.
.
.
}
pour
ajouter,
vérifier
else
{
produit
être
dans
panier
if
(
isset
(
$this->lignes[$code]
)
)
{
$lp
=
$this->lignes[$code]
;
$qte
=
$lp->qte;
s’il
est,
récupérer
$lp->qte
=
$qte
1;
mettre
à
jour
quan-té
}
else
{
$prod
=
new
produit($code,
$nom,
$prix);
$lp
=
new
lignepanier($prod);
s’il
n’y
être
pas,
aller
ajouter
nouvelle
ligne
de
panier
$this->lignes[$code]
=
$lp;
$this->nbproduits
=
$this->nbproduits
1;
}
}
manuele
kirsch
pinheiro
-
up1
/
cri
/
ufr06
ges=on
133
php
:
panier
avancer
func-on
ajouterproduit($code,
$nom,
$prix)
{
supprimer
if
(
isset
(
$this->lignes[$code]
)
)
{
produire
être
dans
panier
$lp
=
$this->lignes[$code]
;
s’il
est,
mettre
à
jour
quan=té,
$lp->qte
=
$lp->qte
-
1
;
supprimer
1
unité
if
(
$lp->qte
<
1)
{
par
contre,
s’il
rester
unset($this->lignes[$code]);
(qte
<
1),
supprimer
ligne
$this->nbproduits
=
$this->nbproduits
-
1;
de
panier
tableau
}
}
}
manuele
kirsch
pinheiro
-
up1
/
cri
/
ufr06
ges=on
134
php
:
panier
avancer
•
c’est
objet
panier
site
aller
manipuler
•
page
«
ctlpanier.php
»
aller
gérer
panier
•
pour
cela,
el
e
aller
devoir
garder
objet
panier
dans
$_session
ctlpanier
panier
+
$_session
+
nbproduits
:
int
+
ajouterproduit
(code,
nom,
prix)
:
int
+
ajouterproduit
(code,
nom,
prix)
+
supprimerproduit
(code)
:
int
+
supprimerproduit
(code)
+
afficherpanier
()
+
calculertotal
()
:
float
+
terminersession
()
+
getnbproduits
()
:
int
<?php
session_start();
include
"panier.php";
.
.
.
?>
<html>
.
.
man
.
u
</ele
kir
htmslch
>
pinheiro
-
up1
/
cri
/
ufr06
ges=on
135
php
:
panier
avancer
•
objet
panier
être
objet
complexe
•
pour
garder
dans
$_session,
aller
falloir
«
compacter
»
:
c’est
sérialisa-on
–
$_session["panier"]
=
serialize($panier)
–
unserialize
(
$_session["panier"]
)
func-on
ajouterproduit($produit,
$nom,
$prix)
{
pour
ajouter
supprimer
un
.
.
.
produit
panier,
aller
$panier
=
unserialize($_session["panier"]);
récupérer,
modifier
$panier->ajouterproduit($produit,
$nom,
$prix);
remeere
dans
session
$_session["panier"]
=
serialize($panier);
.
.
.
func-on
supprimerproduit($produit)
{
.
.
.
$panier
=
unserialize($_session["panier"]);
$panier->supprimerproduit($produit);
$_session["panier"]
=
serialize($panier);
manuele
kirsch
.
.
.
pinheiro
-
up1
/
cri
/
ufr06
ges=on
136
